<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>Impact Report - {{ company_name }}</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@100;300;400;500;700;900&family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        /* --- ê¸°ë³¸ ì„¤ì • --- */
        :root {
            --primary-green: #27AE60;
            --dark-blue: #0d3d56;
            --text-dark: #2c3e50;
            --text-light: #5D6D7E;
            --bg-light: #f8f9fa;
            --border-color: #e9ecef;
            --accent-blue: #3498DB;
            --accent-orange: #FFC107;
        }
        * { box-sizing: border-box; }
        @keyframes fade-in {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        body {
            font-family: 'Noto Sans KR', sans-serif;
            margin: 0;
            background-color: var(--bg-light);
            color: var(--text-dark);
        }
        .page {
            width: 210mm;
            min-height: 297mm;
            padding: 25mm;
            margin: 20mm auto;
            background: #ffffff;
            box-shadow: 0 15px 50px rgba(0, 0, 0, 0.1);
            display: flex;
            flex-direction: column;
            position: relative;
            animation: fade-in 0.6s ease-out forwards;
        }
        h1, h2, h3, h4 {
            font-family: 'Poppins', 'Roboto', sans-serif;
            font-weight: 700;
            margin: 0;
        }
        p {
            line-height: 1.9;
            font-size: 10pt;
            color: var(--text-light);
            font-weight: 400;
        }
        ul { padding-left: 20px; }
        li {
            margin-bottom: 10px;
        }
        li strong {
            color: var(--text-dark);
            font-weight: 700;
        }
        .cover-page {
            padding: 0;
            justify-content: flex-start;
            align-items: flex-start;
            background: url('../image/reportbg.png') no-repeat center center;
            background-size: cover;
            color: #fff;
        }
        .cover-text {
            padding: 60px;
            margin-top: 120px;
            text-align: left;
            line-height: 1.3;
            text-shadow: 0 2px 8px rgba(0,0,0,0.5);
        }
        .cover-text .line1 { font-size: 2rem; letter-spacing: 4px; }
        .cover-text .line2 { font-size: 4.2rem; font-weight: 300; letter-spacing: 1px; }
        .cover-text .line3 { font-size: 3rem; font-weight: 200; margin-top: 8px; }
        .cover-text .line4 { font-size: 1.8rem; font-weight: 300; margin-top: 20px; }
        .main-title {
            font-size: 26pt;
            color: var(--primary-green);
            padding-bottom: 15px;
            margin-bottom: 40px;
            border-bottom: 3px solid var(--primary-green);
        }
        .page-footer {
            margin-top: auto;
            text-align: center;
            font-size: 9pt;
            color: #aaa;
            padding-top: 20px;
            border-top: 1px solid var(--border-color);
            width: calc(100% - 50mm);
            position: absolute;
            bottom: 10mm;
            left: 25mm;
        }
        .page-logo {
            position: absolute;
            top: 5mm;
            right: 20mm;
            width: 120px;
            height: auto;
        }
        .section { margin-bottom: 35px; }
        .section-title {
            font-size: 18pt;
            color: var(--text-dark);
            margin-bottom: 25px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .sub-title {
            font-size: 14pt;
            color: var(--text-dark);
            margin-bottom: 20px;
            font-weight: 600;
        }
        .grid-container-4 { display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; }
        .sdg-main-subtitle {
            font-size: 12pt;
            font-weight: 700;
            color: var(--text-dark);
            margin-bottom: 15px;
        }
        .sdg-goal-group { margin-bottom: 25px; }
        .sdg-goal-group:last-child { margin-bottom: 0; }
        .sdg-card-new {
            display: flex;
            align-items: center;
            gap: 20px;
            background-color: #fff;
            border: 1px solid var(--border-color);
            padding: 20px;
            border-radius: 12px;
        }
        .sdg-color-box {
            width: 50px;
            height: 50px;
            flex-shrink: 0;
            border-radius: 8px;
            background-size: cover;
            background-position: center;
        }
        .sdg-text-content h4 { font-size: 10pt; font-weight: 600; margin-bottom: 8px; }
        .sdg-text-content p { font-size: 9pt; line-height: 1.6; margin: 0; }
        .sdg-detail-goal {
            margin-top: 10px;
            padding: 20px;
            background-color: var(--bg-light);
            border-radius: 8px;
            border-left: 4px solid var(--primary-green);
        }
        .sdg-detail-goal p { font-size: 10pt; margin: 0; color: var(--text-light); }
        .sdg-detail-goal strong { font-weight: 700; color: var(--text-dark); margin-right: 9px; }
        .info-box-new {
            background: linear-gradient(135deg, #F9F9F9, #FFFFFF);
            padding: 25px;
            border-radius: 12px;
            border: 1px solid var(--border-color);
            border-left: 5px solid var(--primary-green);
        }
        .info-box-new p { font-size: 10pt; color: var(--text-dark); margin: 0; }
        .info-box-new strong { color: var(--primary-green); font-weight: 700; }
        .kpi-card-new {
            background: #fff;
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            border: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            min-height: 160px; /* ëª¨ë“  ë°•ìŠ¤ì˜ ìµœì†Œ ë†’ì´ë¥¼ ì§€ì •í•˜ì—¬ í¬ê¸°ë¥¼ í†µì¼ */
            min-width: 0; /* ì»¨í…ì¸ ê°€ ê·¸ë¦¬ë“œ ë°•ìŠ¤ë¥¼ ë„˜ì–´ì„œëŠ” ê²ƒì„ ë°©ì§€ */
        }
        .kpi-card-new h4 {
            font-size: 8pt;
            color: var(--text-light);
            margin-bottom: 15px;
            font-weight: 500;
            min-height: 3em;
            word-wrap: break-word;
            overflow-wrap: break-word;
        }
        .kpi-card-new .value-wrapper {
            line-height: 1.2;
        }
        .kpi-card-new .value {
            font-family: 'Poppins', sans-serif;
            font-size: 24pt;
            font-weight: 700;
            color: var(--primary-green);
            overflow-wrap: break-word; /* ê¸´ ìˆ«ìê°€ ë°•ìŠ¤ë¥¼ ë„˜ì§€ ì•Šë„ë¡ ì„¤ì • */
            display: block;
        }
        .kpi-card-new .value.blue { color: var(--accent-blue); }
        .kpi-card-new .value.accent { color: var(--accent-orange); }
        .kpi-card-new .unit { 
            font-size: 9pt; 
            color: var(--text-light); 
            display: block;
            margin-top: 5px; 
        }
        .kpi-card-new .unit-sub {
            display: block;
            font-size: 8pt;
            color: var(--text-light);
            margin-top: 2px;
        }
        .analysis-item {
            display: grid;
            grid-template-columns: 150px 1fr;
            align-items: start;
            gap: 25px;
            margin-bottom: 30px;
        }
        .analysis-item.right-title { grid-template-columns: 1fr 150px; }
        .analysis-item h3 {
            font-size: 15pt;
            color: #fff;
            background: var(--dark-blue);
            padding: 25px 20px;
            border-radius: 8px;
            text-align: center;
            font-weight: 600;
        }
        .analysis-item p { margin: 0; padding-top: 5px; }
        .chart-container {
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 30px;
            background: #fff;
        }
        .chart-area {
            display: flex;
            justify-content: space-around;
            align-items: flex-end;
            height: 280px;
            padding: 20px 0;
            border-left: 1px solid var(--border-color);
            border-bottom: 1px solid var(--border-color);
            position: relative;
        }
        .bar-group {
            width: 25%;
            height: 100%;
            text-align: center;
            position: relative;
            display: flex;
            justify-content: center;
            align-items: flex-end;
        }
        .bar {
            width: 50px;
            border-radius: 4px 4px 0 0;
            position: relative;
            background: var(--dark-blue);
            z-index: 1;
            transition: height 0.7s ease-out;
        }
        .bar-label {
            position: absolute;
            bottom: -45px;
            width: 100%;
            left: 0;
            font-size: 10pt;
            font-weight: 500;
            color: var(--text-light);
        }
        .bar-value {
            position: absolute;
            top: -25px;
            width: 100%;
            left: 0;
            font-size: 12pt;
            font-weight: 700;
            color: var(--text-dark);
            opacity: 0;
            transition: opacity 0.5s ease-in 0.5s;
        }
        .bar:hover .bar-value {
            opacity: 1;
        }
        .notice-box, .financial-notice {
            margin-top: 15px;
            padding: 15px;
            background-color: #fef9e7;
            border: 1px solid #f8e5a6;
            border-left: 5px solid var(--accent-orange);
            border-radius: 8px;
        }
        .notice-box p, .financial-notice p {
            margin: 0;
            color: #8a6d3b;
            font-size: 9pt;
            line-height: 1.7;
        }
        /* --- PDF ì¸ì‡„ ì „ìš© ìŠ¤íƒ€ì¼ --- */

    @page {
        margin: 0; /* << ğŸ“„ ì´ ë¶€ë¶„ì„ ì¶”ê°€í•´ì•¼ í•©ë‹ˆë‹¤. */
    }

    @media print {
        .page {
            margin: 0;
            box-shadow: none;
        }
    }
    </style>
</head>
<body>

<div class="page cover-page">
    <div class="cover-text">
        <div class="line1">Code Green</div>
        <div class="line2">Impact Report</div>
        <div class="line3">2025</div>
        <div class="line4">{{ company_name }}</div>
    </div>
</div>

<div class="page">
    <img src="../image/A.Impact.png" alt="A.Impact Logo" class="page-logo">
    <h1 class="main-title">I. ê¸°ì—… ë¶„ì„</h1>
    <div class="section">
        <h2 class="section-title">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
            ê¸°ì—… ì†Œê°œ
        </h2>
        <p>{{ company_summary }}</p>
    </div>
    <div class="section">
        <h2 class="section-title">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z"/><path d="M12 2a10 10 0 0 0-10 10c0 4.29 2.68 7.94 6.38 9.38"/><path d="M22 12a10 10 0 0 0-9.38-6.38C16.91 3.32 20.66 7 22 12z"/></svg>
            SDGs ì—°ê³„
        </h2>
        <h3 class="sdg-main-subtitle">ì£¼ìš” ëª©í‘œ ë° ì„¸ë¶€ ëª©í‘œ</h3>
        <div>
            {% for main_key, main_value in sdgs_main.items() %}
            <div class="sdg-goal-group">
                <div class="sdg-card-new">
                    <div class="sdg-color-box" style="background-image: url('../image/sdg_image/sdg{{ main_key }}.png');"></div>
                    <div class="sdg-text-content">
                        <h4>SDG {{ main_key }}: {{ main_value.split('â€”')[0].strip() }}</h4>
                        <p>{{ main_value.split('â€”')[1].strip() }}</p>
                    </div>
                </div>
                <div class="sdg-detail-goal">
                    {% for sub_key, sub_value in sdgs_sub.items() %}
                        {% if sub_key.startswith(main_key + '.') %}
                        <p><strong>SDG {{ sub_key }}:</strong> {{ sub_value.split('â€”')[0].strip() }}</p>
                        {% endif %}
                    {% endfor %}
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
    <div class="page-footer">2</div>
</div>

<div class="page">
    <img src="../image/A.Impact.png" alt="A.Impact Logo" class="page-logo">
    <div class="section">
        <h2 class="section-title">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/><polyline points="3.27 6.96 12 12.01 20.73 6.96"/><line x1="12" y1="22.08" x2="12" y2="12"/></svg>
            ì‚¬íšŒì  ê°€ì¹˜ ì°½ì¶œ í¬ì¸íŠ¸ 
        </h2>
        <p>{{ social_value_point }}</p>
        <div class="info-box-new" style="margin-top: 20px;">
            <p><strong>ğŸ’¡AI í•´ì„¤:</strong> {{ ai_explain }}<br>
            </p>
        </div>
    </div>
    <h1 class="main-title" style="margin-top: 20px; margin-bottom: 20px;">II. ì„íŒ©íŠ¸-ì¬ë¬´ KPI ì—°ë™ ëŒ€ì‹œë³´ë“œ</h1>
    <div class="section">
        <h2 class="sub-title">í•µì‹¬ ì„±ê³¼ ì§€í‘œ (Total)</h2>
        <div class="grid-container-4">
            {% for kpi in impact_kpis %}
            {% set color_class = loop.cycle('', 'blue', 'blue', 'accent') %}
            <div class="kpi-card-new">
                <h4>{{ kpi.name | replace('<br>', ' ') }}</h4>
                <div class="value-wrapper">
                    <span class="value {{ color_class }}"><span class="number-to-format">{{ kpi.value }}</span></span>
                    <span class="unit">{{ kpi.unit }}</span>
                </div>
            </div>
            {% endfor %}
        </div>
        {% if note %}
        <div class="notice-box">
            <p><strong>ì°¸ê³ :</strong> {{ note }}</p>
        </div>
        {% endif %}
    </div>
    <div class="section">
        <h2 class="sub-title">í•µì‹¬ íš¨ìœ¨ì„± ì§€í‘œ (ë§¤ì¶œ 1ì–µë‹¹)</h2>
        {% if linked_kpis and (linked_kpis | map(attribute='value') | sum) > 0 %}
        <div class="grid-container-4">
            {% for kpi in linked_kpis %}
            {% set color_class = loop.cycle('', 'blue', 'blue', 'accent') %}
            <div class="kpi-card-new">
                <h4>{{ kpi.name }}</h4>
                <div class="value-wrapper">
                    {% if '/' in kpi.unit %}
                        {% set unit_parts = kpi.unit.split('/') %}
                        <span class="value {{ color_class }}">
                            <span class="number-to-format">{{ "%.1f"|format(kpi.value|float) }}</span>
                        </span>
                        <span class="unit">{{ unit_parts[0] }}/</span>
                        <span class="unit-sub">{{ unit_parts[1] }}</span>
                    {% else %}
                        <span class="value {{ color_class }}">
                            <span class="number-to-format">{{ "%.1f"|format(kpi.value|float) }}</span>
                        </span>
                        <span class="unit">{{ kpi.unit }}</span>
                    {% endif %}
                </div>
            </div>
            {% endfor %}
        </div>
        {% else %}
        <div class="financial-notice">
             <p><strong>ì°¸ê³ :</strong> í•µì‹¬ ì„±ê³¼ ë°ì´í„°ê°€ ì—†ì–´ ê´€ë ¨ ì§€í‘œê°€ í‘œì‹œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ì •í™•í•œ ë¶„ì„ì„ ì›í•˜ì‹œë©´ ì„±ê³¼ ë°ì´í„°ë¥¼ ì—…ë¡œë“œí•˜ì—¬ ë¦¬í¬íŠ¸ë¥¼ ë‹¤ì‹œ ìƒì„±í•´ ì£¼ì„¸ìš”.</p>
        </div>
        {% endif %}
    </div>
    <div class="page-footer">3</div>
</div>

<div class="page">
    <img src="../image/A.Impact.png" alt="A.Impact Logo" class="page-logo">
    <h1 class="main-title">III. ìƒì„¸ ë¶„ì„</h1>
    <div class="section">
        <h2 class="section-title">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>
            IMP ê¸°ë°˜ ë¶„ì„
        </h2>
        <div class="analysis-item">
            <h3>What</h3>
            <p>{{ what }}</p>
        </div>
        <div class="analysis-item right-title">
            <p>{{ who }}</p>
            <h3>Who</h3>
        </div>
    </div>
    <div class="section">
        <div class="analysis-item">
            <h3>How much</h3>
            <p>{{ how_much }}</p>
        </div>
        <div class="analysis-item right-title">
            <p>{{ risk }}</p>
            <h3>Risk</h3>
        </div>
    </div>
    <div class="page-footer">4</div>
</div>

<div class="page">
    <img src="../image/A.Impact.png" alt="A.Impact Logo" class="page-logo">
    <h1 class="main-title">IV. ë³€í™”ëŸ‰ ë° í™•ì¥ ì „ëµ</h1>
    <div class="section">
        <h2 class="section-title">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/></svg>
            ë§¤ì¶œì•¡ ì¶”ì´ 
        </h2>
        <div class="notice-box">
             <p>ì°¸ê³ : í‘œì‹œí•  ë§¤ì¶œ ì¶”ì´ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤. ë¶„ì„ì„ ì›í•˜ì‹œë©´ ê´€ë ¨ ë°ì´í„°ë¥¼ ì—…ë¡œë“œí•´ ì£¼ì„¸ìš”.</p>
        </div>
    </div>
    <div class="section">
    <h2 class="section-title">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 3h6v6"/><path d="M10 14 21 3"/><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/></svg>
        GRI ì§€í‘œ ì¶”ì²œ
    </h2>
    <ul id="gri-list">
        {% for item in gri_main %}
        <li><strong>{{ item.item_name }} (GRI {{ item.item_code }}):</strong> {{ item.reason }}</li>
        {% endfor %}
    </ul>
</div>
    <div class="page-footer">5</div>
</div>

<div class="page">
    <img src="../image/A.Impact.png" alt="A.Impact Logo" class="page-logo">
    <h1 class="main-title">V. AI ìš”ì•½</h1>
    <div class="section">
        <h2 class="section-title">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 20h9"/><path d="M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z"/></svg>
            ì¢…í•© í‰ê°€
        </h2>
        <p>{{ ai_summary }}</p>
    </div>
    <div class="section">
        <h2 class="section-title">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></svg>
            ì£¼ìš” ì„±ê³¼ ìš”ì•½
        </h2>
        <div class="info-box-new">
            <p>ìš”ì•½í•  ì¶©ë¶„í•œ ì„±ê³¼ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤. ì •í™•í•œ ë¶„ì„ì„ ì›í•˜ì‹œë©´ ê´€ë ¨ ë°ì´í„°ë¥¼ ì—…ë¡œë“œí•˜ì—¬ ë¦¬í¬íŠ¸ë¥¼ ë‹¤ì‹œ ìƒì„±í•´ ì£¼ì„¸ìš”.</p>
        </div>
    </div>
    <div class="page-footer">6</div>
</div>

<div class="page">
    <img src="../image/A.Impact.png" alt="A.Impact Logo" class="page-logo">
    <h1 class="main-title">VI. ë¶€ë¡</h1>
    <div class="section">
        <h2 class="section-title">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20"/></svg>
            ë°ì´í„° ì¶œì²˜ ë° ë°©ë²•ë¡ 
        </h2>
        <ul>
            <li><strong>í•µì‹¬ ì„±ê³¼ ì§€í‘œ ë°ì´í„°:</strong> ë³¸ ë³´ê³ ì„œì˜ í•µì‹¬ ì„±ê³¼ ì§€í‘œëŠ” <strong>ì œì¶œëœ ìë£Œë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì‚°ì¶œ</strong>ë˜ì—ˆìœ¼ë©°, ë¶„ì„ ì‹œì  ë° ë°ì´í„°ì˜ ìµœì‹ ì„±ì— ë”°ë¼ ì‹¤ì œ ê°’ê³¼ ì°¨ì´ê°€ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
            <li><strong>ì„íŒ©íŠ¸ ì¸¡ì • ë°©ë²•ë¡ :</strong> ë³¸ ë³´ê³ ì„œëŠ” <strong>MSCI SDG Alignment Methodology</strong>, <strong>GRI Standards 2021</strong>, <strong>Impact Management Project (IMP) í”„ë ˆì„ì›Œí¬</strong>ë¥¼ ì°¸ê³ í•˜ì—¬ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.</li>
        </ul>
    </div>
    <div class="section">
        <h2 class="section-title">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="M12 16v-4"/><path d="M12 8h.01"/></svg>
            ìš©ì–´ ì„¤ëª…
        </h2>
        <p><strong>GRI (Global Reporting Initiative):</strong> <strong>ì§€ì†ê°€ëŠ¥ì„± ë³´ê³ ì„œì— ëŒ€í•œ ê°€ì´ë“œë¼ì¸</strong>ì„ ì œì‹œí•˜ëŠ” êµ­ì œê¸°êµ¬. ì „ ì„¸ê³„ì ìœ¼ë¡œ ê°€ì¥ ë„ë¦¬ ì±„íƒë˜ëŠ” í‘œì¤€ ì¤‘ í•˜ë‚˜ì…ë‹ˆë‹¤.</p>
        <p><strong>IMP (Impact Management Project):</strong> ê¸°ì—… ë° íˆ¬ììê°€ ì„íŒ©íŠ¸ë¥¼ ì¸¡ì •í•˜ê³  ê´€ë¦¬í•˜ëŠ” ë°©ë²•ì— ëŒ€í•œ ê¸€ë¡œë²Œ ì»¨ì„¼ì„œìŠ¤ë¥¼ êµ¬ì¶•í•˜ëŠ” í”„ë¡œì íŠ¸ì…ë‹ˆë‹¤.</p>
        <p><strong>SDGs (Sustainable Development Goals):</strong> 2030ë…„ê¹Œì§€ ì „ ì„¸ê³„ê°€ í•¨ê»˜ ë‹¬ì„±í•˜ê¸°ë¡œ ì•½ì†í•œ 17ê°œì˜ ì§€ì†ê°€ëŠ¥ë°œì „ëª©í‘œì…ë‹ˆë‹¤.</p>
    </div>
    <div class="page-footer">7</div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // --- Client-Side Enhancements ---
    // ì´ ìŠ¤í¬ë¦½íŠ¸ëŠ” Jinja2ì— ì˜í•´ í˜ì´ì§€ê°€ ë Œë”ë§ëœ í›„ ë¸Œë¼ìš°ì €ì—ì„œ ì‹¤í–‰ë©ë‹ˆë‹¤.

    /**
     * ìˆ«ìë¥¼ 'ë§Œ', 'ì–µ', 'ì¡°' ë‹¨ìœ„ì˜ í•œê¸€ í˜•ì‹ìœ¼ë¡œ ë³€í™˜í•©ë‹ˆë‹¤.
     * 10,000 ë¯¸ë§Œì˜ ìˆ«ìëŠ” ì‰¼í‘œë¥¼ ì¶”ê°€í•˜ì—¬ ë°˜í™˜í•©ë‹ˆë‹¤.
     * ì†Œìˆ˜ì  ì²«ì§¸ ìë¦¬ê¹Œì§€ í‘œì‹œí•˜ë©°, .0ìœ¼ë¡œ ëë‚˜ëŠ” ê²½ìš°ëŠ” ì •ìˆ˜ë¡œ í‘œì‹œí•©ë‹ˆë‹¤.
     * @param {number|string} num - ë³€í™˜í•  ìˆ«ì
     * @returns {string} - ë³€í™˜ëœ ë¬¸ìì—´ (ì˜ˆ: "1.2ë§Œ", "50ì–µ")
     */
    const formatKoreanNumberUnit = (num) => {
        const number = parseFloat(String(num).replace(/,/g, ''));
        if (isNaN(number)) return num; // ìˆ«ìê°€ ì•„ë‹ˆë©´ ì›ë˜ ê°’ ë°˜í™˜

        if (number >= 1000000000000) {
            const formatted = (number / 1000000000000).toFixed(1).replace(/\.0$/, '');
            return `${formatted}ì¡°`;
        }
        if (number >= 100000000) {
            const formatted = (number / 100000000).toFixed(1).replace(/\.0$/, '');
            return `${formatted}ì–µ`;
        }
        if (number >= 10000) {
            const formatted = (number / 10000).toFixed(1).replace(/\.0$/, '');
            return `${formatted}ë§Œ`;
        }
        // 10,000 ë¯¸ë§Œì€ ì‰¼í‘œë§Œ ì¶”ê°€
        return number.toLocaleString('ko-KR');
    };

    /**
     * --- ìˆ˜ì •ëœ í•¨ìˆ˜ ---
     * ìš”ì†Œì˜ í…ìŠ¤íŠ¸ê°€ ë¶€ëª¨ ì»¨í…Œì´ë„ˆ ë„ˆë¹„ë¥¼ ì´ˆê³¼í•˜ì§€ ì•Šë„ë¡ í°íŠ¸ í¬ê¸°ë¥¼ ë™ì ìœ¼ë¡œ ì¡°ì ˆí•©ë‹ˆë‹¤.
     * @param {HTMLElement} element - í°íŠ¸ í¬ê¸°ë¥¼ ì¡°ì ˆí•  í…ìŠ¤íŠ¸ ìš”ì†Œ (e.g., a <span>)
     */
    const adjustFontSize = (element) => {
        // ë„ˆë¹„ì˜ ê¸°ì¤€ì´ ë˜ëŠ” ë¶€ëª¨ ì»¨í…Œì´ë„ˆ(.kpi-card-new)ë¥¼ ì°¾ìŠµë‹ˆë‹¤.
        const container = element.closest('.kpi-card-new');
        if (!container) return;

        const containerStyles = window.getComputedStyle(container);
        // ì»¨í…Œì´ë„ˆì˜ ë‚´ë¶€ íŒ¨ë”© ê°’ì„ ì œì™¸í•œ ì‹¤ì œ ì‚¬ìš© ê°€ëŠ¥í•œ ë„ˆë¹„ë¥¼ ê³„ì‚°í•©ë‹ˆë‹¤.
        const paddingLeft = parseFloat(containerStyles.paddingLeft);
        const paddingRight = parseFloat(containerStyles.paddingRight);
        const availableWidth = container.clientWidth - paddingLeft - paddingRight;

        // í°íŠ¸ í¬ê¸° ì¡°ì ˆ ì „, ì›ë˜ CSSì— ì§€ì •ëœ ê°’ìœ¼ë¡œ ì´ˆê¸°í™”í•©ë‹ˆë‹¤.
        element.style.fontSize = ''; 
        let fontSize = parseFloat(window.getComputedStyle(element).fontSize);
        
        // í…ìŠ¤íŠ¸ê°€ í•œ ì¤„ì¼ ë•Œì˜ ì „ì²´ ë„ˆë¹„ë¥¼ ì¸¡ì •í•˜ê¸° ìœ„í•´ ì„ì‹œë¡œ white-space ì†ì„±ì„ ë³€ê²½í•©ë‹ˆë‹¤.
        element.style.whiteSpace = 'nowrap';

        // í…ìŠ¤íŠ¸ì˜ ë„ˆë¹„ê°€ ì‚¬ìš© ê°€ëŠ¥í•œ ë„ˆë¹„ë³´ë‹¤ í¬ë©´, í°íŠ¸ í¬ê¸°ë¥¼ 1pxì”© ì¤„ì…ë‹ˆë‹¤.
        while (element.scrollWidth > availableWidth && fontSize > 8) {
            fontSize -= 1; 
            element.style.fontSize = `${fontSize}px`;
        }
        
        // ì¸¡ì •ì´ ëë‚œ í›„ white-space ì†ì„±ì„ ì›ë˜ëŒ€ë¡œ ë˜ëŒë¦½ë‹ˆë‹¤.
        element.style.whiteSpace = '';
    };

    // --- ìˆ˜ì •ëœ ë¶€ë¶„: í•¨ìˆ˜ í˜¸ì¶œ ë¡œì§ ---
    // 1. KPI ìˆ«ìë¥¼ í•œê¸€ ë‹¨ìœ„ í¬ë§·ìœ¼ë¡œ ë³€ê²½í•˜ê³  í°íŠ¸ í¬ê¸° ì¡°ì ˆ
    document.querySelectorAll('.number-to-format').forEach(span => {
        const originalValue = span.textContent.trim();
        const formattedValue = formatKoreanNumberUnit(originalValue);
        span.textContent = formattedValue;
        // ë¶€ëª¨(.value) ìš”ì†Œì˜ í°íŠ¸ í¬ê¸°ë¥¼ ì¡°ì ˆ
        adjustFontSize(span.parentElement);
    });

    // 2. ì°¨íŠ¸ ë°” ì• ë‹ˆë©”ì´ì…˜ íš¨ê³¼
    document.querySelectorAll('.bar').forEach((bar, index) => {
        const finalHeight = bar.dataset.height;
        const barValue = bar.querySelector('.bar-value');
        
        // ìˆœì°¨ì ìœ¼ë¡œ ì• ë‹ˆë©”ì´ì…˜ ì‹œì‘
        setTimeout(() => {
            bar.style.height = finalHeight;
            if(barValue) {
                barValue.style.opacity = 1;
            }
        }, 150 * index);
    });
});
</script>

</body>
</html>
